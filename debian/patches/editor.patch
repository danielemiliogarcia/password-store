From 9d695896eb87482f98bdec16d19eb43c048b345d Mon Sep 17 00:00:00 2001
From: Colin Watson <cjwatson@debian.org>
Date: Sat, 4 Jan 2014 14:29:57 +0000
Subject: Use editor(1) rather than vi(1) if EDITOR is unset

Bug-Debian: http://bugs.debian.org/722254
Forwarded: not-needed
Last-Update: 2014-04-14

Patch-Name: editor.patch
---
 man/pass.1            | 2 +-
 src/password-store.sh | 6 +++---
 2 files changed, 4 insertions(+), 4 deletions(-)

diff --git a/man/pass.1 b/man/pass.1
index 35c81ee..d02d625 100644
--- a/man/pass.1
+++ b/man/pass.1
@@ -104,7 +104,7 @@ before overwriting an existing password, unless \fI--force\fP or \fI-f\fP is spe
 \fBedit\fP \fIpass-name\fP
 Insert a new password or edit an existing password using the default text editor specified
 by the environment variable \fIEDITOR\fP or using
-.BR vi (1)
+.BR editor (1)
 as a fallback. This mode makes use of temporary files for editing, but care is taken to
 ensure that temporary files are created in \fI/dev/shm\fP in order to avoid writing to
 difficult-to-erase disk sectors. If \fI/dev/shm\fP is not accessible, fallback to
diff --git a/src/password-store.sh b/src/password-store.sh
index 2945b33..83de20b 100755
--- a/src/password-store.sh
+++ b/src/password-store.sh
@@ -228,7 +228,7 @@ cmd_usage() {
 	        during entry. Or, optionally, the entry may be multiline. Prompt before
 	        overwriting existing password unless forced.
 	    $PROGRAM edit pass-name
-	        Insert a new password or edit an existing password using ${EDITOR:-vi}.
+	        Insert a new password or edit an existing password using ${EDITOR:-editor}.
 	    $PROGRAM generate [--no-symbols,-n] [--clip,-c] [--force,-f] pass-name pass-length
 	        Generate a new password of pass-length with optionally no symbols.
 	        Optionally put it on the clipboard and clear board after 45 seconds.
@@ -444,12 +444,12 @@ cmd_edit() {
 		$GPG -d -o "$tmp_file" "${GPG_OPTS[@]}" "$passfile" || exit 1
 		action="Edit"
 	fi
-	${EDITOR:-vi} "$tmp_file"
+	${EDITOR:-editor} "$tmp_file"
 	while ! $GPG -e "${GPG_RECIPIENT_ARGS[@]}" -o "$passfile" "${GPG_OPTS[@]}" "$tmp_file"; do
 		echo "GPG encryption failed. Retrying."
 		sleep 1
 	done
-	git_add_file "$passfile" "$action password for $path using ${EDITOR:-vi}."
+	git_add_file "$passfile" "$action password for $path using ${EDITOR:-editor}."
 }
 
 cmd_generate() {
